webpackJsonp([6],{"3C/1":function(e,t,s){s("M6a0"),s("zQR9"),s("+tPU"),s("qCoq"),s("UvrK"),s("Xjd4"),s("bqnK"),e.exports=s("FeBl").Map},"4WTo":function(e,t,s){var i=s("NWt+");e.exports=function(e,t){var s=[];return i(e,!1,s.push,s,t),s}},"5PlU":function(e,t,s){var i=s("RY/4"),n=s("dSzd")("iterator"),r=s("/bQp");e.exports=s("FeBl").isIterable=function(e){var t=Object(e);return void 0!==t[n]||"@@iterator"in t||r.hasOwnProperty(i(t))}},"7Doy":function(e,t,s){var i=s("EqjI"),n=s("7UMu"),r=s("dSzd")("species");e.exports=function(e){var t;return n(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!n(t.prototype)||(t=void 0),i(t)&&null===(t=t[r])&&(t=void 0)),void 0===t?Array:t}},"9Bbf":function(e,t,s){"use strict";var i=s("kM2E");e.exports=function(e){i(i.S,e,{of:function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];return new this(t)}})}},"9C8M":function(e,t,s){"use strict";var i=s("evD5").f,n=s("Yobk"),r=s("xH/j"),o=s("+ZMJ"),a=s("2KxR"),c=s("NWt+"),u=s("vIB/"),l=s("EGZi"),d=s("bRrM"),p=s("+E39"),f=s("06OY").fastKey,v=s("LIJb"),h=p?"_s":"size",m=function(e,t){var s,i=f(t);if("F"!==i)return e._i[i];for(s=e._f;s;s=s.n)if(s.k==t)return s};e.exports={getConstructor:function(e,t,s,u){var l=e(function(e,i){a(e,l,t,"_i"),e._t=t,e._i=n(null),e._f=void 0,e._l=void 0,e[h]=0,void 0!=i&&c(i,s,e[u],e)});return r(l.prototype,{clear:function(){for(var e=v(this,t),s=e._i,i=e._f;i;i=i.n)i.r=!0,i.p&&(i.p=i.p.n=void 0),delete s[i.i];e._f=e._l=void 0,e[h]=0},delete:function(e){var s=v(this,t),i=m(s,e);if(i){var n=i.n,r=i.p;delete s._i[i.i],i.r=!0,r&&(r.n=n),n&&(n.p=r),s._f==i&&(s._f=n),s._l==i&&(s._l=r),s[h]--}return!!i},forEach:function(e){v(this,t);for(var s,i=o(e,arguments.length>1?arguments[1]:void 0,3);s=s?s.n:this._f;)for(i(s.v,s.k,this);s&&s.r;)s=s.p},has:function(e){return!!m(v(this,t),e)}}),p&&i(l.prototype,"size",{get:function(){return v(this,t)[h]}}),l},def:function(e,t,s){var i,n,r=m(e,t);return r?r.v=s:(e._l=r={i:n=f(t,!0),k:t,v:s,p:i=e._l,n:void 0,r:!1},e._f||(e._f=r),i&&(i.n=r),e[h]++,"F"!==n&&(e._i[n]=r)),e},getEntry:m,setStrong:function(e,t,s){u(e,t,function(e,s){this._t=v(e,t),this._k=s,this._l=void 0},function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?l(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,l(1))},s?"entries":"values",!s,!0),d(t)}}},ALrJ:function(e,t,s){var i=s("+ZMJ"),n=s("MU5D"),r=s("sB3e"),o=s("QRG4"),a=s("oeOm");e.exports=function(e,t){var s=1==e,c=2==e,u=3==e,l=4==e,d=6==e,p=5==e||d,f=t||a;return function(t,a,v){for(var h,m,g=r(t),x=n(g),_=i(a,v,3),b=o(x.length),k=0,y=s?f(t,b):c?f(t,0):void 0;b>k;k++)if((p||k in x)&&(m=_(h=x[k],k,g),e))if(s)y[k]=m;else if(m)switch(e){case 3:return!0;case 5:return h;case 6:return k;case 2:y.push(h)}else if(l)return!1;return d?-1:u||l?l:y}}},Cdx3:function(e,t,s){var i=s("sB3e"),n=s("lktj");s("uqUo")("keys",function(){return function(e){return n(i(e))}})},HpRW:function(e,t,s){"use strict";var i=s("kM2E"),n=s("lOnJ"),r=s("+ZMJ"),o=s("NWt+");e.exports=function(e){i(i.S,e,{from:function(e){var t,s,i,a,c=arguments[1];return n(this),(t=void 0!==c)&&n(c),void 0==e?new this:(s=[],t?(i=0,a=r(c,arguments[2],2),o(e,!1,function(e){s.push(a(e,i++))})):o(e,!1,s.push,s),new this(s))}})}},LIJb:function(e,t,s){var i=s("EqjI");e.exports=function(e,t){if(!i(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},TmV0:function(e,t,s){s("fZOM"),e.exports=s("FeBl").Object.values},UvrK:function(e,t,s){var i=s("kM2E");i(i.P+i.R,"Map",{toJSON:s("m9gC")("Map")})},Xd32:function(e,t,s){s("+tPU"),s("zQR9"),e.exports=s("5PlU")},Xjd4:function(e,t,s){s("9Bbf")("Map")},Zjy4:function(e,t){},bqnK:function(e,t,s){s("HpRW")("Map")},d7EF:function(e,t,s){"use strict";t.__esModule=!0;var i=r(s("us/S")),n=r(s("BO1k"));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(){return function(e,t){if(Array.isArray(e))return e;if((0,i.default)(Object(e)))return function(e,t){var s=[],i=!0,r=!1,o=void 0;try{for(var a,c=(0,n.default)(e);!(i=(a=c.next()).done)&&(s.push(a.value),!t||s.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&c.return&&c.return()}finally{if(r)throw o}}return s}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},fZOM:function(e,t,s){var i=s("kM2E"),n=s("mbce")(!1);i(i.S,"Object",{values:function(e){return n(e)}})},fZjL:function(e,t,s){e.exports={default:s("jFbC"),__esModule:!0}},gRE1:function(e,t,s){e.exports={default:s("TmV0"),__esModule:!0}},ifoU:function(e,t,s){e.exports={default:s("3C/1"),__esModule:!0}},jFbC:function(e,t,s){s("Cdx3"),e.exports=s("FeBl").Object.keys},m9gC:function(e,t,s){var i=s("RY/4"),n=s("4WTo");e.exports=function(e){return function(){if(i(this)!=e)throw TypeError(e+"#toJSON isn't generic");return n(this)}}},mWTg:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("fZjL"),n=s.n(i),r=s("ifoU"),o=s.n(r),a=s("woOf"),c=s.n(a),u=s("mvHQ"),l=s.n(u),d=s("gRE1"),p=s.n(d),f=s("+6Bu"),v=s.n(f),h=s("d7EF"),m=s.n(h),g={name:"goods-form",props:{oldGoods:{type:Object},isEdit:{type:Boolean,default:!1},step:{type:Number,default:1}},data:function(){return{valid:!1,goods:{categories:[],brandId:0,title:"",subTitle:"",spuDetail:{packingList:"",afterService:"",description:""}},brandOptions:[],specs:[],specialSpecs:[]}},methods:{submit:function(){var e=this;this.$refs.basic.validate||this.$message.error("请先完成表单内容！");var t=this.goods,s=m()(t.categories,3),i=s[0].id,n=s[1].id,r=s[2].id,o=v()(t,["categories"]),a={};this.specs.forEach(function(e){var t=e.id,s=e.v;a[t]=s});var u={};this.specialSpecs.forEach(function(e){var t=e.id,s=e.options;u[t]=s});var d=this.skus.filter(function(e){return e.enable}).map(function(t){var s=t.price,i=t.stock,n=t.enable,r=t.images,a=t.indexes,c=v()(t,["price","stock","enable","images","indexes"]),u=o.title+" "+p()(c).map(function(e){return e.v}).join(" "),d={};return p()(c).forEach(function(e){d[e.id]=e.v}),{price:e.$format(s),stock:i,indexes:a,enable:n,title:u,images:r?r.join(","):"",ownSpec:l()(d)}});c()(o,{cid1:i,cid2:n,cid3:r,skus:d}),o.spuDetail.genericSpec=l()(a),o.spuDetail.specialSpec=l()(u),this.$http({method:this.isEdit?"put":"post",url:"/item/goods",data:o}).then(function(){e.$emit("close"),e.$message.success("保存成功了")}).catch(function(){e.$message.error("保存失败！")})}},watch:{oldGoods:{deep:!0,handler:function(e){if(this.isEdit){this.goods=Object.deepCopy(e);var t=e.cname.split("/");this.goods.categories=[{id:e.cid1,name:t[0]},{id:e.cid2,name:t[1]},{id:e.cid3,name:t[2]}];var s=new o.a;this.goods.skus.forEach(function(e){s.set(e.indexes,e)}),this.goods.skus=s}else c()(this.goods,{categories:null,brandId:0,title:"",subTitle:"",spuDetail:{packingList:"",afterService:"",description:""}}),this.specs=[],this.specialSpecs=[]}},"goods.categories":{deep:!0,handler:function(e){var t=this;e&&e.length>0&&(this.$http.get("/item/brand/cid/"+this.goods.categories[2].id).then(function(e){var s=e.data;t.brandOptions=s}),this.$http.get("/item/spec/params?cid="+this.goods.categories[2].id).then(function(e){var s=e.data,i=[],n=[];t.isEdit&&(i=JSON.parse(t.goods.spuDetail.genericSpec),n=JSON.parse(t.goods.spuDetail.specialSpec));var r=[],o=[];s.forEach(function(e){var s=e.id,a=e.name,c=e.generic,u=e.numeric,l=e.unit;if(c){var d={id:s,name:a,numeric:u,unit:l};t.isEdit&&(d.v=i[s]),r.push(d)}else{var p={id:s,name:a,options:[]};t.isEdit&&(p.options=n[s]),o.push(p)}}),t.specs=r,t.specialSpecs=o}))}}},computed:{skus:function(){var e=this,t=this.specialSpecs.filter(function(e){return e.options.length>0});return t.reduce(function(s,i,n){var r=[];return s.forEach(function(s){i.options.forEach(function(o,a){var u=JSON.parse(l()(s));if(u[i.name]={v:o,id:i.id},u.indexes=(u.indexes||"")+"_"+a,n===t.length-1&&(u.indexes=u.indexes.substring(1),c()(u,{price:0,stock:0,enable:!1,images:[]}),e.isEdit)){var d=e.goods.skus.get(u.indexes);if(null!=d){var p=d.price,f=d.stock,v=d.enable,h=d.images;c()(u,{price:e.$format(p),stock:f,enable:v,images:h?h.split(","):[]})}}r.push(u)})}),r},[{}])},headers:function(){if(this.skus.length<=0)return[];var e=[];return n()(this.skus[0]).forEach(function(t){var s=t;if("price"===t)t="价格";else if("stock"===t)t="商机资源";else if("enable"===t)t="是否启用";else if("images"===t||"indexes"===t)return;e.push({text:t,align:"center",sortable:!1,value:s})}),e}}},x={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-stepper",{model:{value:e.step,callback:function(t){e.step=t},expression:"step"}},[s("v-stepper-header",[s("v-stepper-step",{attrs:{complete:e.step>1,step:"1"}},[e._v("基本信息")]),e._v(" "),s("v-divider"),e._v(" "),s("v-stepper-step",{attrs:{complete:e.step>2,step:"2"}},[e._v("商机描述")]),e._v(" "),s("v-divider"),e._v(" "),s("v-stepper-step",{attrs:{complete:e.step>3,step:"3"}},[e._v("商机参数")]),e._v(" "),s("v-divider"),e._v(" "),s("v-stepper-step",{attrs:{step:"4"}},[e._v("SKU属性")])],1),e._v(" "),s("v-stepper-items",[s("v-stepper-content",{attrs:{step:"1"}},[s("v-flex",{staticClass:"xs10 mx-auto"},[s("v-form",{ref:"basic",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("v-layout",{attrs:{row:""}},[s("v-flex",{attrs:{xs5:""}},[s("v-cascader",{attrs:{url:"/item/category/list",required:"",showAllLevels:"",label:"请选择商机分类"},model:{value:e.goods.categories,callback:function(t){e.$set(e.goods,"categories",t)},expression:"goods.categories"}})],1),e._v(" "),s("v-spacer"),e._v(" "),s("v-flex",{attrs:{xs5:""}},[s("v-select",{attrs:{items:e.brandOptions,"item-text":"name","item-value":"id",label:"所属行业",required:"",autocomplete:"",clearable:"",dense:"",chips:"",rules:[function(e){return!!e||"行业不能为空"}]},scopedSlots:e._u([{key:"selection",fn:function(t){return[s("v-chip",{attrs:{small:""}},[e._v(e._s(t.item.name))])]}}]),model:{value:e.goods.brandId,callback:function(t){e.$set(e.goods,"brandId",t)},expression:"goods.brandId"}})],1)],1),e._v(" "),s("v-text-field",{attrs:{label:"商机标题",counter:200,required:"",rules:[function(e){return!!e||"商机标题不能为空"}],"hide-details":""},model:{value:e.goods.title,callback:function(t){e.$set(e.goods,"title",t)},expression:"goods.title"}}),e._v(" "),s("v-text-field",{attrs:{label:"商机特征",counter:200,"hide-details":""},model:{value:e.goods.subTitle,callback:function(t){e.$set(e.goods,"subTitle",t)},expression:"goods.subTitle"}}),e._v(" "),s("v-text-field",{attrs:{label:"商机列表",counter:1e3,"multi-line":"",rows:3,"hide-details":""},model:{value:e.goods.spuDetail.packingList,callback:function(t){e.$set(e.goods.spuDetail,"packingList",t)},expression:"goods.spuDetail.packingList"}}),e._v(" "),s("v-text-field",{attrs:{label:"售后服务",counter:1e3,"multi-line":"",rows:3,"hide-details":""},model:{value:e.goods.spuDetail.afterService,callback:function(t){e.$set(e.goods.spuDetail,"afterService",t)},expression:"goods.spuDetail.afterService"}})],1)],1)],1),e._v(" "),s("v-stepper-content",{attrs:{step:"2"}},[s("v-editor",{attrs:{"upload-url":"/upload/image"},model:{value:e.goods.spuDetail.description,callback:function(t){e.$set(e.goods.spuDetail,"description",t)},expression:"goods.spuDetail.description"}})],1),e._v(" "),s("v-stepper-content",{attrs:{step:"3"}},[s("v-flex",{staticClass:"xs10 mx-auto px-3"},[s("v-card",{staticClass:"my-2"},[s("v-container",{attrs:{"grid-list-md":"",fluid:""}},[s("v-layout",{staticClass:"px-5",attrs:{wrap:"",row:"","justify-space-between":""}},e._l(e.specs,function(t){return s("v-flex",{key:t.name,attrs:{xs12:"",sm5:""}},[s("v-text-field",{attrs:{label:t.name,suffix:t.unit||""},model:{value:t.v,callback:function(s){e.$set(t,"v",s)},expression:"param.v"}})],1)}))],1)],1)],1)],1),e._v(" "),s("v-stepper-content",{attrs:{step:"4"}},[s("v-flex",{staticClass:"mx-auto"},[e._l(e.specialSpecs,function(t){return s("v-card",{key:t.name,attrs:{flat:""}},[s("div",{staticClass:"subheading"},[e._v(e._s(t.name)+":")]),e._v(" "),s("v-card-text",{staticClass:"px-5"},e._l(t.options.length+1,function(i){return s("div",{key:i,staticClass:"layout row px-5"},[s("v-text-field",{staticClass:"flex xs10",attrs:{placeholder:"新的"+t.name+":","auto-grow":"",value:i,"single-line":"","hide-details":""},model:{value:t.options[i-1],callback:function(s){e.$set(t.options,i-1,s)},expression:"spec.options[i-1]"}}),e._v(" "),i<=t.options.length?s("v-btn",{attrs:{icon:""},on:{click:function(e){t.options.splice(i-1,1)}}},[s("i",{staticClass:"el-icon-delete"})]):e._e()],1)}))],1)}),e._v(" "),s("v-card",{staticClass:"elevation-0"},[s("div",{staticClass:"subheading py-3"},[e._v("SKU列表:")]),e._v(" "),s("v-divider"),e._v(" "),s("v-data-table",{staticClass:"elevation-0",attrs:{items:e.skus,headers:e.headers,"hide-actions":"","item-key":"indexes"},scopedSlots:e._u([{key:"items",fn:function(t){return[s("tr",{on:{click:function(e){t.expanded=!t.expanded}}},e._l(t.item,function(i,n){return["price","stock"].includes(n)?s("td",{key:n,staticClass:"text-xs-center"},[s("v-text-field",{attrs:{"single-line":""},on:{click:function(e){e.stopPropagation()}},model:{value:t.item[n],callback:function(s){e.$set(t.item,n,s)},expression:"props.item[k]"}})],1):"enable"===n?s("td",{staticClass:"text-xs-center"},[s("v-checkbox",{model:{value:t.item[n],callback:function(s){e.$set(t.item,n,s)},expression:"props.item[k]"}})],1):"images"!==n&&"indexes"!==n?s("td",{staticClass:"text-xs-center"},[e._v(e._s(i.v))]):e._e()}))]}},{key:"expand",fn:function(t){return[s("v-card",{staticClass:"elevation-2 flex xs11 mx-auto my-2"},[s("v-upload",{attrs:{url:"/upload/image"},model:{value:t.item.images,callback:function(s){e.$set(t.item,"images",s)},expression:"props.item.images"}})],1)]}}])})],1)],2),e._v(" "),s("v-flex",{attrs:{xs3:"","offset-xs9":""}},[s("v-btn",{attrs:{color:"info"},on:{click:e.submit}},[e._v("保存商机信息")])],1)],1)],1)],1)},staticRenderFns:[]};var _=s("VU/8")(g,x,!1,function(e){s("Zjy4")},"data-v-2e1720e4",null);t.default=_.exports},mbce:function(e,t,s){var i=s("lktj"),n=s("TcQ7"),r=s("NpIQ").f;e.exports=function(e){return function(t){for(var s,o=n(t),a=i(o),c=a.length,u=0,l=[];c>u;)r.call(o,s=a[u++])&&l.push(e?[s,o[s]]:o[s]);return l}}},oeOm:function(e,t,s){var i=s("7Doy");e.exports=function(e,t){return new(i(e))(t)}},qCoq:function(e,t,s){"use strict";var i=s("9C8M"),n=s("LIJb");e.exports=s("qo66")("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=i.getEntry(n(this,"Map"),e);return t&&t.v},set:function(e,t){return i.def(n(this,"Map"),0===e?0:e,t)}},i,!0)},qo66:function(e,t,s){"use strict";var i=s("7KvD"),n=s("kM2E"),r=s("06OY"),o=s("S82l"),a=s("hJx8"),c=s("xH/j"),u=s("NWt+"),l=s("2KxR"),d=s("EqjI"),p=s("e6n0"),f=s("evD5").f,v=s("ALrJ")(0),h=s("+E39");e.exports=function(e,t,s,m,g,x){var _=i[e],b=_,k=g?"set":"add",y=b&&b.prototype,E={};return h&&"function"==typeof b&&(x||y.forEach&&!o(function(){(new b).entries().next()}))?(b=t(function(t,s){l(t,b,e,"_c"),t._c=new _,void 0!=s&&u(s,g,t[k],t)}),v("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","),function(e){var t="add"==e||"set"==e;e in y&&(!x||"clear"!=e)&&a(b.prototype,e,function(s,i){if(l(this,b,e),!t&&x&&!d(s))return"get"==e&&void 0;var n=this._c[e](0===s?0:s,i);return t?this:n})}),x||f(b.prototype,"size",{get:function(){return this._c.size}})):(b=m.getConstructor(t,e,g,k),c(b.prototype,s),r.NEED=!0),p(b,e),E[e]=b,n(n.G+n.W+n.F,E),x||m.setStrong(b,e,g),b}},uqUo:function(e,t,s){var i=s("kM2E"),n=s("FeBl"),r=s("S82l");e.exports=function(e,t){var s=(n.Object||{})[e]||Object[e],o={};o[e]=t(s),i(i.S+i.F*r(function(){s(1)}),"Object",o)}},"us/S":function(e,t,s){e.exports={default:s("Xd32"),__esModule:!0}}});
//# sourceMappingURL=6.792ae433979043aa59c5.js.map